class YouTube{Url(t){return this.tabelaList=null,this.url=t,this.verificateUrl()}verificateUrl(){var t=this.url,e="";return void 0!==(t=t.replace(/(>|<)/gi,"").split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/)/))[2]&&(e=t[2].split(/[^0-9a-z_\-]/i),this.id=e[0],!0)}async youtubeApiV3(t,e){var a="https://www.googleapis.com/youtube/v3/"+t+"?";const s=Object.keys(e),i=s.length;for(var n=0;n<i;n++)a+=s[n]+"="+e[s[n]]+"&";return a+="key=AIzaSyBII7L44auzJSKZbYoJ3YwGFKMcjoIvaDI",await this.request(a)}async googleVideo(t){var e="https://video.google.com/timedtext?";const a=Object.keys(t),s=a.length;for(var i=0;i<s;i++)e+=a[i]+"="+t[a[i]]+"&";return await this.request(e.slice(0,-1))}async request(t){return await $.get(t)}async traduzir(t){const e="https://translate.yandex.net/api/v1.5/tr.json/translate?key=trnsl.1.1.20190308T222210Z.e5566cee85b5528e.2cf9c95b00b1f82525b9282bc22effd7f9144e53&text="+t+"&lang=en-pt";return(await this.request(e)).text[0]}async tabela(t){return null==this.tabelaList&&(this.tabelaList=await $.getJSON("https://raw.githubusercontent.com/gsbenevides2/xml-to-srt/development/languages.json")),this.tabelaList.targets.indexOf(t)>=0?this.tabelaList.targetsTranslate[this.tabelaList.targets.indexOf(t)]:await this.traduzir(t)}async legendsData(){const t={type:"list",v:this.id,tlangs:1},e=await this.googleVideo(t),a=[],s=e.getElementsByTagName("track").length,i=[],n=e.getElementsByTagName("target").length;if(0==s)return this.legends=null,this.traducoes=null,null;for(let t=0;t<s;t++){const s=e.getElementsByTagName("track")[t],i={id:s.getAttribute("id"),name:s.getAttribute("name"),lang_code:s.getAttribute("lang_code"),lang_name:await this.tabela(s.getAttribute("lang_translated"))};a.push(i)}if(n>0){for(let t=0;t<n;t++){const a=e.getElementsByTagName("target")[t],s=a.getAttribute("urlfrag").slice(1).split("=")[1],n={id:a.getAttribute("id"),tlang:s,lang_name:await this.tabela(a.getAttribute("lang_translated"))};i.push(n)}this.traducoes=i}return this.legends=a,{traducoes:i,legendas:a}}async processLegend(t){const e=this.legends[t.option],a={v:this.id,type:"track",name:e.name,lang:e.lang_code};"original"!=t.traduzir&&(a.tlang=this.traducoes[t.traduzir].tlang);const s=new xml(await this.googleVideo(a));this.legend=s.toSrt()}async VideoData(){const t={part:"snippet,contentDetails",id:this.id},e=await this.youtubeApiV3("videos",t);return 0!=e.items.length?(this.videoName=e.items[0].snippet.title,{name:e.items[0].snippet.title,canal:e.items[0].snippet.channelTitle,time:{segundos:e.items[0].contentDetails.duration.slice(2,-1).split("M")[1],minutos:e.items[0].contentDetails.duration.slice(2,-1).split("M")[0]},image:e.items[0].snippet.thumbnails.maxres.url}):null}}