class YouTube{constructor(a){this.page=a}Url(a){return this.tabelaList=null,this.url=a,this.verificateUrl()}verificateUrl(){var a=this.url,b='';return a=a.replace(/(>|<)/gi,'').split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/)/),void 0!==a[2]&&(b=a[2].split(/[^0-9a-z_\-]/i),this.id=b[0],!0)}async youtubeApiV3(a,b){var c='https://www.googleapis.com/youtube/v3/'+a+'?';const d=Object.keys(b),e=d.length;for(var f=0;f<e;f++)c+=d[f]+'='+b[d[f]]+'&';return c+='key=AIzaSyBII7L44auzJSKZbYoJ3YwGFKMcjoIvaDI',await this.request(c)}async googleVideo(a=null){var b='https://video.google.com/timedtext?';if(null!=a){const d=Object.keys(a),e=d.length;for(var c=0;c<e;c++)b+=d[c]+'='+a[d[c]]+'&'}return await this.request(b.slice(0,-1))}async request(a){return this.requestQtd=1,await this.requestGo(a)}async requestGo(a){return 5==this.requestQtd?void this.page.error('fail'):await $.get(a,a=>a).fail(async b=>404==b.status?void this.page.error(404):(0==b.status&&this.page.error(0,this.requestQtd+1),++this.requestQtd,await this.requestGo(a)))}async traduzir(a){const b=await this.request('https://translate.yandex.net/api/v1.5/tr.json/translate?key=trnsl.1.1.20190308T222210Z.e5566cee85b5528e.2cf9c95b00b1f82525b9282bc22effd7f9144e53&text='+a+'&lang=en-pt');return b.text[0]}async tabela(a){return null==this.tabelaList&&(this.tabelaList=await $.getJSON('https://raw.githubusercontent.com/gsbenevides2/xml-to-srt/development/languages.json')),0<=this.tabelaList.targets.indexOf(a)?this.tabelaList.targetsTranslate[this.tabelaList.targets.indexOf(a)]:await this.traduzir(a)}async legendsData(){const a={type:'list',v:this.id,tlangs:1},b=await this.googleVideo(a),c=[],d=b.getElementsByTagName('track').length,e=[],f=b.getElementsByTagName('target').length;if(0==d)return this.legends=null,this.traducoes=null,null;for(let a=0;a<d;a++){const d=b.getElementsByTagName('track')[a],e={id:d.getAttribute('id'),name:d.getAttribute('name'),lang_code:d.getAttribute('lang_code'),lang_name:await this.tabela(d.getAttribute('lang_translated'))};c.push(e)}if(0<f){for(let a=0;a<f;a++){const c=b.getElementsByTagName('target')[a],d=c.getAttribute('urlfrag').slice(1).split('=')[1],f={id:c.getAttribute('id'),tlang:d,lang_name:await this.tabela(c.getAttribute('lang_translated'))};e.push(f)}this.traducoes=e}return this.legends=c,{traducoes:e,legendas:c}}async processLegend(a){const b=this.legends[a.option],c={v:this.id,type:'track',name:b.name,lang:b.lang_code};'original'!=a.traduzir&&(c.tlang=this.traducoes[a.traduzir].tlang);const d=new xml((await this.googleVideo(c)));this.legend=d.toSrt()}async VideoData(){const a={part:'snippet,contentDetails',id:this.id},b=await this.youtubeApiV3('videos',a);return 0==b.items.length?null:(this.videoName=b.items[0].snippet.title,{name:b.items[0].snippet.title,canal:b.items[0].snippet.channelTitle,time:{segundos:b.items[0].contentDetails.duration.slice(2,-1).split('M')[1],minutos:b.items[0].contentDetails.duration.slice(2,-1).split('M')[0]},image:b.items[0].snippet.thumbnails.maxres.url})}}